[{"content": "| Action Tokenization | Example | Contextual | Unordered |\n|---|---|---|---| \n| Product Quantization | VQ-Rec [2023] | \u2717 | \u2714 |\n| Hierarchical Clustering | P5-CID [2023] | \u2717 | \u2717 |\n| Residual Quantization | TIGER [2023] | \u2717 | \u2717 |\n| Text Tokenization | LMIndexer [2024] | \u2717 | \u2717 |\n| Raw Features | HSTU [2024] | \u2717 | \u2717 |\n| SentencePiece | SPM-SID [2024] | \u2717 | \u2717 |\n| ActionPiece | Ours | \u2714 | \u2714 |", "caption": "Table 1: Comparison of different action tokenization methods for generative recommendation.\n\u201cContextual\u201d denotes whether the same actions can be tokenized into different tokens based on the surrounding context.\n\u201cUnordered\u201d denotes whether the item features or semantic IDs are used in an order-agnostic manner.", "description": "\ud45c 1\uc740 \uc0dd\uc131\uc801 \ucd94\ucc9c\uc744 \uc704\ud55c \ub2e4\uc591\ud55c \ud589\ub3d9 \ud1a0\ud070\ud654 \ubc29\ubc95\ub4e4\uc744 \ube44\uad50\ud55c \ud45c\uc785\ub2c8\ub2e4.  \"Contextual\" \uc5f4\uc740 \uc8fc\ubcc0 \ubb38\ub9e5\uc5d0 \ub530\ub77c \ub3d9\uc77c\ud55c \ud589\ub3d9\uc774 \ub2e4\ub978 \ud1a0\ud070\uc73c\ub85c \ubcc0\ud658\ub420 \uc218 \uc788\ub294\uc9c0\ub97c \ub098\ud0c0\ub0b4\uace0, \"Unordered\" \uc5f4\uc740 \ud56d\ubaa9 \ud2b9\uc9d5 \ub610\ub294 \uc758\ubbf8 ID\uac00 \uc21c\uc11c\uc5d0 \uc0c1\uad00\uc5c6\uc774 \uc0ac\uc6a9\ub418\ub294\uc9c0\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  \uac01 \ud589\ub3d9 \ud1a0\ud070\ud654 \ubc29\ubc95\uc5d0 \ub300\ud55c \uc608\uc2dc\uc640 \ud568\uaed8, Contextual \uc5ec\ubd80\uc640 Unordered \uc5ec\ubd80\ub97c \uccb4\ud06c \ud45c\uc2dc\ud558\uc5ec \ube44\uad50 \ubd84\uc11d\ud558\uc600\uc2b5\ub2c8\ub2e4.", "section": "2. \uad00\ub828 \uc5f0\uad6c"}, {"content": "| Datasets | Metric | ID-based BERT4Rec | ID-based SASRec | ID-based FDSA | Feature + ID S<sup>3</sup>-Rec | Feature + ID VQ-Rec | Feature + ID P5-CID | Generative TIGER | Generative LMIndexer | Generative HSTU | Generative SPM-SID | Generative ActionPiece | Improv. |\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n| Sports | R@5 | 0.0115 | 0.0233 | 0.0182 | 0.0251 | 0.0181 | 0.0287 | 0.0264 | 0.0222 | 0.0258 | 0.0280 | **0.0316 \u00b1 0.0005** | +12.86% |\n|  | N@5 | 0.0075 | 0.0154 | 0.0122 | 0.0161 | 0.0132 | 0.0179 | 0.0181 | 0.0142 | 0.0165 | 0.0180 | **0.0205 \u00b1 0.0002** | +11.71% |\n|  | R@10 | 0.0191 | 0.0350 | 0.0288 | 0.0385 | 0.0251 | 0.0426 | 0.0400 |  \u2014 | 0.0414 | 0.0446 | **0.0500 \u00b1 0.0007** | +12.11% |\n|  | N@10 | 0.0099 | 0.0192 | 0.0156 | 0.0204 | 0.0154 | 0.0224 | 0.0225 |  \u2014 | 0.0215 | 0.0234 | **0.0264 \u00b1 0.0003** | +12.82% |\n| Beauty | R@5 | 0.0203 | 0.0387 | 0.0267 | 0.0387 | 0.0434 | 0.0468 | 0.0454 | 0.0415 | 0.0469 | 0.0475 | **0.0511 \u00b1 0.0014** | +7.58% |\n|  | N@5 | 0.0124 | 0.0249 | 0.0163 | 0.0244 | 0.0311 | 0.0315 | 0.0321 | 0.0262 | 0.0314 | 0.0321 | **0.0340 \u00b1 0.0011** | +5.92% |\n|  | R@10 | 0.0347 | 0.0605 | 0.0407 | 0.0647 | 0.0741 | 0.0701 | 0.0648 |  \u2014 | 0.0704 | 0.0714 | **0.0775 \u00b1 0.0017** | +4.59% |\n|  | N@10 | 0.0170 | 0.0318 | 0.0208 | 0.0327 | 0.0372 | 0.0400 | 0.0384 |  \u2014 | 0.0389 | 0.0399 | **0.0424 \u00b1 0.0011** | +6.00% |\n| CDs | R@5 | 0.0326 | 0.0351 | 0.0226 | 0.0213 | 0.0314 | 0.0505 | 0.0492 |  \u2014 | 0.0417 | 0.0509 | **0.0544 \u00b1 0.0005** | +6.88% |\n|  | N@5 | 0.0201 | 0.0177 | 0.0137 | 0.0130 | 0.0209 | 0.0326 | 0.0329 |  \u2014 | 0.0275 | 0.0337 | **0.0359 \u00b1 0.0004** | +6.53% |\n|  | R@10 | 0.0547 | 0.0619 | 0.0378 | 0.0375 | 0.0485 | 0.0785 | 0.0748 |  \u2014 | 0.0638 | 0.0778 | **0.0830 \u00b1 0.0008** | +5.73% |\n|  | N@10 | 0.0271 | 0.0263 | 0.0186 | 0.0182 | 0.0264 | 0.0416 | 0.0411 |  \u2014 | 0.0346 | 0.0424 | **0.0451 \u00b1 0.0005** | +6.37% |", "caption": "Table 2: Performance comparison of different methods on the Amazon Reviews dataset\u00a0(McAuley et\u00a0al., 2015). The best and second-best performance is denoted in bold and underlined fonts. \u201cR@K\u201d and \u201cN@K\u201d are short for \u201cRecall@K\u201d and \u201cNDCG@K\u201d, respectively. \u201cImprov.\u201d denotes the percentage improvement of our method compared to the strongest baseline method.", "description": "\ud45c 2\ub294 Amazon \uc0c1\ud488\ud3c9 \ub370\uc774\ud130\uc14b(McAuley et al., 2015)\uc5d0\uc11c \ub2e4\uc591\ud55c \ucd94\ucc9c \ubc29\ubc95\ub4e4\uc758 \uc131\ub2a5\uc744 \ube44\uad50\ud55c \ud45c\uc785\ub2c8\ub2e4.  \ud45c\uc5d0\ub294 \uc5ec\ub7ec \ucd94\ucc9c \ubaa8\ub378(BERT4Rec, SASRec, FDSA, S3-Rec, VQ-Rec, P5-CID, TIGER, LMIndexer, HSTU, SPM-SID, ActionPiece)\uc758 Recall@K\uc640 NDCG@K \uc9c0\ud45c\uac00 \uc81c\uc2dc\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4.  K\uac12\uc740 5\uc640 10\uc744 \uc0ac\uc6a9\ud558\uc600\uc2b5\ub2c8\ub2e4.  \uac00\uc7a5 \uc6b0\uc218\ud55c \uc131\ub2a5\uc740 \uad75\uc740 \uae00\uc528\uccb4\ub85c \uac15\uc870 \ud45c\uc2dc\ub418\uc5c8\uc73c\uba70, ActionPiece \ubaa8\ub378\uc758 \uc131\ub2a5 \ud5a5\uc0c1\ub960\uc740 \uac00\uc7a5 \uac15\ub825\ud55c \uae30\uc900 \ubaa8\ub378 \ub300\ube44 \ubc31\ubd84\uc728\ub85c \ud45c\uc2dc\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4.  \uc989, \uc774 \ud45c\ub294 ActionPiece \ubaa8\ub378\uc774 \uae30\uc874\uc758 \uc5ec\ub7ec \ucd94\ucc9c \ubaa8\ub378\ubcf4\ub2e4 \uc6b0\uc218\ud55c \uc131\ub2a5\uc744 \ubcf4\uc784\uc744 \ubcf4\uc5ec\uc8fc\ub294 \uc2e4\ud5d8 \uacb0\uacfc\ub97c \uc81c\uc2dc\ud569\ub2c8\ub2e4.", "section": "4. \uacb0\uacfc"}, {"content": "| Variants | Sports | Beauty | CDs |\n|---|---|---|---|\n| **TIGER with larger vocabularies** |\n| (1.1) TIGER - 1k (4 \u00d7 2<sup>8</sup>) | 0.0225 | 0.0384 | 0.0411 |\n| (1.2) TIGER-49k (6 \u00d7 2<sup>13</sup>) | 0.0162 | 0.0317 | 0.0338 |\n| (1.3) TIGER-66k (4 \u00d7 2<sup>14</sup>) | 0.0194 | N/A<sup>\u2020</sup> | 0.0319 |\n| **Vocabulary construction** |\n| (2.1) _w/o_ tokenization | 0.0215 | 0.0389 | 0.0346 |\n| (2.2) _w/o_ context-aware | 0.0258 | 0.0416 | 0.0429 |\n| (2.3) _w/o_ weighted counting | 0.0257 | 0.0412 | 0.0435 |\n| **Set permutation regularization** |\n| (3.1) only for inference | 0.0192 | 0.0316 | 0.0329 |\n| (3.2) only for training | 0.0244 | 0.0387 | 0.0422 |\n| ActionPiece (40k) | **0.0264** | **0.0424** | **0.0451** |", "caption": "Table 3: Ablation analysis of ActionPiece. The recommendation performance is measured using NDCG@10101010. The best performance is denoted in bold fonts.", "description": "\ud45c 3\uc740 ActionPiece\uc758 ablation study \uacb0\uacfc\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  NDCG@10 \uc9c0\ud45c\ub97c \uc0ac\uc6a9\ud558\uc5ec \ucd94\ucc9c \uc131\ub2a5\uc744 \uce21\uc815\ud588\uc2b5\ub2c8\ub2e4.  \uac01 \ubcc0\uc218 \uc81c\uac70 \uc2e4\ud5d8\uc744 \ud1b5\ud574 ActionPiece\uc758 \uc131\ub2a5 \ud5a5\uc0c1\uc5d0 \uae30\uc5ec\ud558\ub294 \uc694\uc18c\ub97c \ubd84\uc11d\ud558\uc600\uc2b5\ub2c8\ub2e4.  \uac01 \uc2e4\ud5d8\uc5d0\uc11c NDCG@10 \uac12\uc774 \uac00\uc7a5 \ub192\uc740 \uacb0\uacfc\ub294 \uad75\uc740 \uae00\uc528\uccb4\ub85c \ud45c\uc2dc\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4.  \ub2e4\uc591\ud55c \ubcc0\uc218 \uc81c\uac70\ub97c \ud1b5\ud574, \ubb38\ub9e5 \uc778\uc2dd \ud1a0\ud070\ud654, \uac00\uc911\uce58 \ubd80\uc5ec\ub41c \uacf5\ub3d9 \ucd9c\ud604 \ud69f\uc218 \uacc4\uc0b0, \uc9d1\ud569 \uc21c\uc5f4 \uc815\uaddc\ud654 (SPR) \ub4f1\uc774 ActionPiece \uc131\ub2a5 \ud5a5\uc0c1\uc5d0 \uc911\uc694\ud558\uac8c \uc791\uc6a9\ud568\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.", "section": "4.3. Ablation Study"}, {"content": "This table summarizes notations used in the paper. \n\n| Notation | Explaination |\n|---|---| \n| $i$, $i_1$, $i_j$ | item, item identifier, item ID |\n| $t$ | the number of actions in the input action sequence; the timestamp when the model makes a prediction |\n| $i_{t+1}$ | the ground-truth next item |\n| $\"{i}_{t+1}$ | the predicted next item |\n| $S = \\{i_1, i_2, \\ldots, i_t\\}$ | the action sequence where each action is represented with the interacted item ID |\n| $\"{\"}, \"{\"}_1, \"{\"}_j$ | a set of item features or tokens |\n| $m = |\\mathcal{A}_j|$ | the number of features associated with each item |\n| $f_{j,k}$ | the $k$-th feature of item $i_j$ |\n| $\\mathcal{F}_k$ | the collection of all possible choices for the $k$-th feature |\n| $S' = \\{\\mathcal{A}_1, \\mathcal{A}_2, \\ldots, \\mathcal{A}_t\\}$ | the action sequence where each action is represented with a set of item features |\n| $c$, $c_1$, $c_j$ | input & generated tokens |\n| $l$ | the number of tokens in the token sequence |\n| $C = \\{c_1, c_2, \\ldots, c_l\\}$ | the token sequence tokenized from the input action sequence $S'$ |\n| $\\{c_{l+1}, \\ldots, c_q\\}$ | the tokens generated by the GR model |\n| $\\mathcal{V}$ | vocabulary of ActionPiece tokenizer |\n| $\\mathcal{R}$ | merge rules of ActionPiece tokenizer |\n| $\\{(c_u, c_v) \\to c_{new}\\}$ | one merge rule indicating two adjacent tokens $c_u$ and $c_v$ can be replaced by a token $c_{new}$ |\n| $Q = |\\mathcal{V}|$ | size of ActionPiece vocabulary |\n| $P(c, c')$ | probability that tokens $c$ and $c'$ are adjacent when flattening a sequence of sets into a token sequence |\n| $N$ | the number of action sequences in the training corpus |\n| $L$ | the average length of action sequences in the training corpus |\n| $H$ | Maximal heap size, $O(NLm)$|", "caption": "Table 4: Notations and explanations.", "description": "\ud45c 4\ub294 \ub17c\ubb38\uc5d0\uc11c \uc0ac\uc6a9\ub41c \ud45c\uae30\ubc95\uacfc \uc124\uba85\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  \uac01 \ud45c\uae30\ubc95\uc740 \ubcc0\uc218 \uc774\ub984, \ub370\uc774\ud130 \uc720\ud615, \uadf8\ub9ac\uace0 \ud574\ub2f9 \ubcc0\uc218\uc5d0 \ub300\ud55c \uac04\ub7b5\ud55c \uc124\uba85\uc744 \ub2f4\uace0 \uc788\uc2b5\ub2c8\ub2e4.  \uc608\ub97c \ub4e4\uc5b4, 'S = {i1, i2,..., it}'\ub294 \uc0ac\uc6a9\uc790\uc758 \uacfc\uac70 \ud589\ub3d9 \uc2dc\ud000\uc2a4\ub97c \ub098\ud0c0\ub0b4\uba70, 'Aj'\ub294 \uac01 \ud589\ub3d9\uc5d0 \uad00\ub828\ub41c \uc544\uc774\ud15c \ud2b9\uc9d5\ub4e4\uc758 \uc9d1\ud569\uc744 \ub098\ud0c0\ub0c5\ub2c8\ub2e4.  \uc774 \ud45c\ub294 \ub17c\ubb38\uc758 \ubc29\ubc95\ub860 \ubd80\ubd84\uc744 \uc774\ud574\ud558\ub294 \ub370 \ud544\uc218\uc801\uc778 \uc815\ubcf4\ub97c \ub2f4\uace0 \uc788\uc2b5\ub2c8\ub2e4.", "section": "3. Method"}, {"content": "| Aspect | BPE | ActionPiece |\n|---|---|---|\n| **Data Type** | text sequences | action (unordered feature set) sequences |\n| **Token** | a byte sequence | a feature set |\n| **Initial Vocabulary** | single bytes | single-feature sets |\n| **Merging Unit** | adjacent byte pairs | feature pairs within one set or between adjacent sets |\n| **Co-occurrence Weighting** | raw frequency counting | probabilistic weighting (Figure 2) |\n| **Segmentation Strategy** | greedy fixed-order merging | set permutation regularization (Algorithm 4) |\n| **Intermediate Structures** | N/A | intermediate nodes for cross-action merges |", "caption": "Table 5: Comparison between ActionPiece and BPE.", "description": "\ud45c 5\ub294 ActionPiece\uc640 BPE\uc758 \ucc28\uc774\uc810\uc744 \ube44\uad50\ud55c \ud45c\uc785\ub2c8\ub2e4. \ub450 \uc54c\uace0\ub9ac\uc998 \ubaa8\ub450 \ubc18\ubcf5\uc801\uc778 \ubc29\uc2dd\uc73c\ub85c \uc5b4\ud718\ub97c \uad6c\uc131\ud558\uc9c0\ub9cc, ActionPiece\ub294 \uc21c\uc11c\uac00 \uc5c6\ub294 \ud2b9\uc9d5 \uc9d1\ud569 \uc2dc\ud000\uc2a4\uc5d0 \ub300\ud574 \ub3d9\uc791\ud558\ub3c4\ub85d \uc124\uacc4\ub41c \ubc18\uba74, BPE\ub294 \ud14d\uc2a4\ud2b8 \uc2dc\ud000\uc2a4\uc5d0 \ub300\ud574 \ub3d9\uc791\ud558\ub3c4\ub85d \uc124\uacc4\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ud45c\uc5d0\ub294 \ub370\uc774\ud130 \uc720\ud615, \ud1a0\ud070, \ucd08\uae30 \uc5b4\ud718, \ubcd1\ud569 \ub2e8\uc704, \ub3d9\uc2dc \ubc1c\uc0dd \ube48\ub3c4 \uac00\uc911\uce58, \ubd84\ud560 \uc804\ub7b5, \uc911\uac04 \uad6c\uc870 \ub4f1\uc758 \uce21\uba74\uc5d0\uc11c \ub450 \uc54c\uace0\ub9ac\uc998\uc758 \ucc28\uc774\uc810\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.", "section": "3.2. Contextual Action Sequence Tokenizer"}, {"content": "| Datasets | #Users | #Items | #Actions | Avg. t |\n|---|---|---|---|---|\n| **Sports** | 18,357 | 35,598 | 260,739 | 8.32 |\n| **Beauty** | 22,363 | 12,101 | 176,139 | 8.87 |\n| **CDs** | 75,258 | 64,443 | 1,022,334 | 14.58 |", "caption": "Table 6: Statistics of the processed datasets. \u201cAvg.\u00a0t\ud835\udc61titalic_t\u201d denotes the average number of actions in an action sequence.", "description": "\ud45c 6\uc740 \uc2e4\ud5d8\uc5d0 \uc0ac\uc6a9\ub41c \uc138 \uac1c\uc758 \uc544\ub9c8\uc874 \ub9ac\ubdf0 \ub370\uc774\ud130\uc14b(\uc2a4\ud3ec\uce20, \ubdf0\ud2f0, CD)\uc758 \ud1b5\uacc4\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \uac01 \ub370\uc774\ud130\uc14b\uc5d0 \ub300\ud574 \uc0ac\uc6a9\uc790 \uc218, \uc544\uc774\ud15c \uc218, \uc0c1\ud638\uc791\uc6a9 \uc218(\uc561\uc158 \uc218), \uadf8\ub9ac\uace0 \uc561\uc158 \uc2dc\ud000\uc2a4 \ub2f9 \ud3c9\uade0 \uc561\uc158 \uc218\ub97c \ub098\ud0c0\ub0c5\ub2c8\ub2e4. \uc774 \uc815\ubcf4\ub294 \uac01 \ub370\uc774\ud130\uc14b\uc758 \uaddc\ubaa8\uc640 \ud2b9\uc9d5\uc744 \ud30c\uc545\ud558\ub294 \ub370 \ub3c4\uc6c0\uc774 \ub418\uba70, \ubaa8\ub378 \uc131\ub2a5 \ube44\uad50\uc5d0 \uc911\uc694\ud55c \ub9e5\ub77d\uc744 \uc81c\uacf5\ud569\ub2c8\ub2e4.", "section": "4.1. Experimental Setup"}, {"content": "| Hyperparameter | Sports | Beauty | CDs |\n|---|---|---|---|\n| learning_rate | 0.005 | 0.001 | 0.001 |\n| warmup_steps | 10,000 | 10,000 | 10,000 |\n| dropout_rate | 0.1 | 0.1 | 0.1 |\n| weight_decay | 0.15 | 0.15 | 0.07 |\n| vocabulary_size | 40,000 | 40,000 | 40,000 |\n| n_inference_segments | 5 | 5 | 5 |\n| beam_size | 50 | 50 | 50 |\n| num_layers | 4 | 4 | 4 |\n| d_model | 128 | 128 | 256 |\n| d_ff | 1,024 | 1,024 | 2,048 |\n| num_heads | 6 | 6 | 6 |\n| d_kv | 64 | 64 | 64 |\n| optimizer | adamw | adamw | adamw |\n| lr_scheduler | cosine | cosine | cosine |\n| train_batch_size | 256 | 256 | 256 |\n| max_epochs | 200 | 200 | 200 |\n| early_stop_patience | 20 | 20 | 20 |", "caption": "Table 7: Hyperparameter settings of ActionPiece for each dataset.", "description": "\ud45c 7\uc740 ActionPiece \ubaa8\ub378\uc758 \ud558\uc774\ud37c\ud30c\ub77c\ubbf8\ud130 \uc124\uc815\uc744 \uc138 \uac1c\uc758 \ub370\uc774\ud130\uc14b(Sports, Beauty, CDs)\uc5d0 \ub300\ud574 \uac01\uac01 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \ud559\uc2b5\ub960, \uc6cc\ubc0d\uc5c5 \uc2a4\ud15d, \ub4dc\ub86d\uc544\uc6c3 \ube44\uc728, \uac00\uc911\uce58 \uac10\uc1e0, \uc5b4\ud718 \ud06c\uae30, \ucd94\ub860 \uc2dc \uc559\uc0c1\ube14 \uc138\uadf8\uba3c\ud2b8 \uc218, \ube54 \ud06c\uae30, \ub808\uc774\uc5b4 \uc218, \ubaa8\ub378 \ucc28\uc6d0, \ud53c\ub4dc\ud3ec\uc6cc\ub4dc \ucc28\uc6d0, \ud5e4\ub4dc \uc218, \ud0a4/\uac12 \ucc28\uc6d0, \ucd5c\uc801\ud654 \uc54c\uace0\ub9ac\uc998, \ud559\uc2b5\ub960 \uc2a4\ucf00\uc904\ub7ec, \ubc30\uce58 \ud06c\uae30, \uc5d0\ud3ed \uc218, \uc870\uae30 \uc885\ub8cc \uc870\uac74 \ub4f1\uc758 \ud558\uc774\ud37c\ud30c\ub77c\ubbf8\ud130 \uac12\ub4e4\uc774 \ub370\uc774\ud130\uc14b\ubcc4\ub85c \uc790\uc138\ud788 \uc81c\uc2dc\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4. \uc774 \ud45c\ub294 ActionPiece \ubaa8\ub378\uc758 \uc131\ub2a5\uc5d0 \uc601\ud5a5\uc744 \ubbf8\uce58\ub294 \ub2e4\uc591\ud55c \ud558\uc774\ud37c\ud30c\ub77c\ubbf8\ud130\ub4e4\uc744 \uc870\uc815\ud558\uace0 \ucd5c\uc801\ud654\ud558\ub294 \uacfc\uc815\uc744 \ubcf4\uc5ec\uc8fc\ub294 \uc911\uc694\ud55c \uc815\ubcf4\ub97c \uc81c\uacf5\ud569\ub2c8\ub2e4.", "section": "4.1 \uc2e4\ud5d8 \uc124\uc815"}]