<br><table id='10' style='font-size:16px'><tr><td colspan="2">Require: Visual features: I E Rbsxc and textual features: T E Rbsxc, the row-wise and column- wise size of a tile: tr and tc.</td></tr><tr><td>1:</td><td>Divide I into Ir where i = 1,2, . . . , nr.</td></tr><tr><td>2:</td><td>Divide T into Tj where j = 1, 2, · · . , nc.</td></tr><tr><td>3:</td><td>parallel for each Ir do</td></tr><tr><td>4:</td><td>Load Ii from HBM to on-chip SRAM.</td></tr><tr><td>5:</td><td>Initialize in = 0 E Rtr.</td></tr><tr><td>6:</td><td>for j = 1 to nr do</td></tr><tr><td>7:</td><td>Load Tj from HBM to on-chip SRAM.</td></tr><tr><td>8:</td><td>On chip, compute Xi⌀ = Ii · Th E Rtrxtc.</td></tr><tr><td>9:</td><td>On chip, calculate tile LSE li⌀j based on Equation 5:</td></tr><tr><td>10:</td><td>li⌀s = mi⌀j + LSE(Xi,j - mi,j), where mi⌀i rowmax( Xi,j).</td></tr><tr><td>11:</td><td>On chip, update LSE li based on Equation 4:</td></tr><tr><td>12:</td><td>li ← 12 + log(1 + exp(livi - lr)).</td></tr><tr><td>13:</td><td>end for</td></tr><tr><td>14:</td><td>Write li to HBM.</td></tr><tr><td>15:</td><td>end parallel for</td></tr><tr><td>16:</td><td>Return l.</td></tr></table>