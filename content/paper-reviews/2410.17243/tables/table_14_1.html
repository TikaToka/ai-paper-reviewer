<br><table id='6' style='font-size:14px'><tr><td colspan="2">Require: Saved intermediate variables from the forward pass: visual textual</td></tr><tr><td></td><td>features I E Rbxc, features T E Rbxc. the local LSE vector l E Rb. , The row-wise and column-wise size of a tile: tr and tc,</td></tr><tr><td>1:</td><td>Divide I into Ir i = 1, 2, , Nr.</td></tr><tr><td></td><td>, where . . ·</td></tr><tr><td>2:</td><td>Divide T into Tj , where j = 1 2, . . · , nc.</td></tr><tr><td>3:</td><td>Divide l into lr, where i = 1, 2, . · · , Nr.</td></tr><tr><td>4:</td><td>Initialize gradients vectors: dI E Rtrxc and dT E Rtcxc.</td></tr><tr><td>5:</td><td>for each In do</td></tr><tr><td>6:</td><td>Load Ii and li from HBM to on-chip SRAM.</td></tr><tr><td>7:</td><td>Initialize dIi = 0 E Rtrxc.</td></tr><tr><td>8:</td><td>for j = 1 to [b//tc] do</td></tr><tr><td>9:</td><td>Load To from HBM to on-chip SRAM.</td></tr><tr><td>10: 11:</td><td>On chip, compute Xi,j = Ii · T⌀ E Rtrxtc. On chip, compute dXi⌀j = exp(Xi,j - lr) E Rtrxtc.</td></tr><tr><td>12:</td><td>Update gradients dIi += dXi⌀j · T⌀.</td></tr><tr><td>13:</td><td>Load dT) from HBM to on-chip SRAM.</td></tr><tr><td></td><td>dT⌀ += Ii · dXi,j.</td></tr><tr><td>14: 15:</td><td>Write updated dT⌀ back to HBM.</td></tr><tr><td>16:</td><td>end for</td></tr><tr><td>17:</td><td>Write updated dI⌀ back to HBM.</td></tr><tr><td>18:</td><td>end for</td></tr><tr><td>19:</td><td>return dI(i.e. ai ), dT(i.e. 이정 ).</td></tr></table>