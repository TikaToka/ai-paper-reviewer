[{"content": "| D | N | Adam | \\mathcal{L} (\\downarrow) | \\rm Acc (\\uparrow) | \\rm Iso (\\uparrow) | \\|\\mu\\| (\\downarrow) | \\|\\mu\\|\\rm r (\\downarrow) | \\overline{r} (\\uparrow) | \\rho (\\uparrow) | \\kappa (\\uparrow) |\n|---|---|---|---|---|---|---|---|---|---|---|---| \n| \\resultsS |  |  |  |  |  |  |  |  |  |  | ", "caption": "Table 1: Results of our small-scale experiments. D\ud835\udc37Ditalic_D and N\ud835\udc41Nitalic_N denote the dataset and model size, respectively. \u2112\u2112\\mathcal{L}caligraphic_L is the test loss, and the column AccAcc\\rm Accroman_Acc represents the accuracy averaged over the downstream tasks listed in Sec.\u00a04.3. The other evaluation metrics are defined in the same section, see Eqs.\u00a0(25)-(28). The arrow in parentheses indicates whether a higher or lower value is desirable. Every training was conducted S=3\ud835\udc463S=3italic_S = 3 times with different seeds, and the numbers represent the (rounded) averages and standard deviations in the following shorthand notation format: 0.1230.1230.1230.123\u00a0(4)4(4)( 4 ) \u22610.123\u00b10.004absentplus-or-minus0.1230.004\\equiv 0.123\\pm 0.004\u2261 0.123 \u00b1 0.004. For each combination (D,N)\ud835\udc37\ud835\udc41(D,N)( italic_D , italic_N ) and each metric, the respective better value is highlighted in bold if the (unrounded) difference is significant according to Student\u2019s t-test with a one-sided confidence level of \u03b1=95%\ud835\udefcpercent95\\alpha=95\\%italic_\u03b1 = 95 % (see App.\u00a0F for details). Plots for \u2112\u2112\\mathcal{L}caligraphic_L and AccAcc\\rm Accroman_Acc are shown in App.\u00a0G.1.", "description": "\ud45c 1\uc740 \ub17c\ubb38\uc758 \uc18c\uaddc\ubaa8 \uc2e4\ud5d8 \uacb0\uacfc\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  D\ub294 \ub370\uc774\ud130\uc14b \ud06c\uae30, N\uc740 \ubaa8\ub378 \ud06c\uae30\ub97c \ub098\ud0c0\ub0c5\ub2c8\ub2e4. \u2112\uc740 \ud14c\uc2a4\ud2b8 \uc190\uc2e4\uc774\uace0, Acc \uc5f4\uc740 4.3\uc808\uc5d0 \ub098\uc5f4\ub41c \ub2e4\uc6b4\uc2a4\ud2b8\ub9bc \uc791\uc5c5\uc5d0 \ub300\ud55c \ud3c9\uade0 \uc815\ud655\ub3c4\ub97c \ub098\ud0c0\ub0c5\ub2c8\ub2e4. \ub2e4\ub978 \ud3c9\uac00 \uc9c0\ud45c\ub294 \uac19\uc740 \uc139\uc158(\uc2dd 25~28)\uc5d0 \uc815\uc758\ub418\uc5b4 \uc788\uc73c\uba70, \uad04\ud638 \uc548\uc758 \ud654\uc0b4\ud45c\ub294 \ub354 \ub192\uc740 \uac12\uc774 \ubc14\ub78c\uc9c1\ud55c\uc9c0 \ub0ae\uc740 \uac12\uc774 \ubc14\ub78c\uc9c1\ud55c\uc9c0\ub97c \ub098\ud0c0\ub0c5\ub2c8\ub2e4. \ubaa8\ub4e0 \ud6c8\ub828\uc740 \uc11c\ub85c \ub2e4\ub978 \uc2dc\ub4dc\ub97c \uc0ac\uc6a9\ud558\uc5ec S=3\ubc88 \ubc18\ubcf5\ub418\uc5c8\uc73c\uba70, \ud45c\uc758 \uc22b\uc790\ub294 \ubc18\uc62c\ub9bc\ub41c \ud3c9\uade0\uacfc \ud45c\uc900 \ud3b8\ucc28\ub97c \ub098\ud0c0\ub0c5\ub2c8\ub2e4. \uc608\ub97c \ub4e4\uc5b4, 0.123 (4)\ub294 0.123 \u00b1 0.004\ub97c \uc758\ubbf8\ud569\ub2c8\ub2e4. \uac01 (D, N) \uc870\ud569\uacfc \uac01 \uc9c0\ud45c\uc5d0 \ub300\ud574, (\ubc18\uc62c\ub9bc\ub418\uc9c0 \uc54a\uc740) \ucc28\uc774\uac00 \uc77c\ubc29\uc801 \uc2e0\ub8b0 \uc218\uc900 \u03b1=95%\uc758 Student t-\uac80\uc815\uc5d0 \ub530\ub77c \uc720\uc758\ubbf8\ud55c \uacbd\uc6b0 \ud574\ub2f9 \uac12\uc774 \uad75\uac8c \ud45c\uc2dc\ub429\ub2c8\ub2e4(\uc790\uc138\ud55c \ub0b4\uc6a9\uc740 \ubd80\ub85d F \ucc38\uc870).  \u2112\uacfc Acc\uc5d0 \ub300\ud55c \uadf8\ub798\ud504\ub294 \ubd80\ub85d G.1\uc5d0 \ub098\uc640 \uc788\uc2b5\ub2c8\ub2e4.", "section": "4 Experiments"}, {"content": "| D | N | Adam | $\\mathcal{L}$ ($\\downarrow$) | Acc ($\\uparrow$) | Iso ($\\uparrow$) | $\\|\\mu\\|$ ($\\downarrow$) | $\\|\\mu\\|^r$ ($\\downarrow$) | $\\overline{r}$ ($\\uparrow$) | $\\rho$ ($\\uparrow$) | $\\kappa$ ($\\uparrow$) |\n|---|---|---|---|---|---|---|---|---|---|---|\n| \\resultsL |  |  |  |  |  |  |  |  |  |  |", "caption": "Table 2: Results of our large-scale experiments. See the caption of Tab.\u00a04.3 for an explanation of the column names. For each combination (D,N)\ud835\udc37\ud835\udc41(D,N)( italic_D , italic_N ) and each metric, the respective better value is highlighted in bold.", "description": "\ud45c 2\ub294 \ubcf8 \ub17c\ubb38\uc758 \ub300\uaddc\ubaa8 \uc2e4\ud5d8 \uacb0\uacfc\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \ud45c\uc758 \uac01 \uc5f4\uc740 \ud14c\uc2a4\ud2b8 \uc190\uc2e4, \ub2e4\uc6b4\uc2a4\ud2b8\ub9bc \uc791\uc5c5 \uc815\ud655\ub3c4, \uc784\ubca0\ub529 \ub4f1\ubc29\uc131, \ud3c9\uade0 \uc784\ubca0\ub529 \ubca1\ud130 \ud06c\uae30, \uc784\ubca0\ub529 \ubca1\ud130\uc758 \ud3c9\uade0 \ud06c\uae30, \uc784\ubca0\ub529 \ubca1\ud130 \uae38\uc774\uc640 \ub2e8\uc77c \ub2e8\uc5b4 \ud655\ub960 \uac04\uc758 \uc0c1\uad00 \uad00\uacc4, \uadf8\ub9ac\uace0 \uc784\ubca0\ub529 \ud589\ub82c\uc758 \uc870\uac74 \uc218\ub97c \ub098\ud0c0\ub0c5\ub2c8\ub2e4. \uac01 \uc9c0\ud45c\uc5d0 \ub300\ud574 \ub354 \ub192\uc740 \uac12\uc774 \ubc14\ub78c\uc9c1\ud55c\uc9c0 \ub354 \ub0ae\uc740 \uac12\uc774 \ubc14\ub78c\uc9c1\ud55c\uc9c0\ub294 \ud654\uc0b4\ud45c\ub85c \ud45c\uc2dc\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4. \ub370\uc774\ud130 \ud06c\uae30(D)\uc640 \ubaa8\ub378 \ud06c\uae30(N)\uc758 \uac01 \uc870\ud569\uc5d0 \ub300\ud574 \ud45c\uc900 Adam\uacfc Coupled Adam\uc744 \uc0ac\uc6a9\ud558\uc5ec \ud6c8\ub828\ub41c \ub450 \uac1c\uc758 \ubaa8\ub378 \uacb0\uacfc\uac00 \uc81c\uc2dc\ub429\ub2c8\ub2e4.  \uac01 \uc9c0\ud45c\uc5d0 \ub300\ud574 \ub354 \ub098\uc740 \uac12\uc740 \uad75\uac8c \ud45c\uc2dc\ub429\ub2c8\ub2e4. \ud45c\uc900 Adam\uacfc Coupled Adam\uc740 \ubaa8\ub450 \uc784\ubca0\ub529 \ub9e4\uac1c\ubcc0\uc218\uc5d0 \uc801\uc6a9\ub418\uba70, \ub2e4\ub978 \ubaa8\ub4e0 \ub9e4\uac1c\ubcc0\uc218\uc5d0\ub294 \ud45c\uc900 Adam\uc774 \uc0ac\uc6a9\ub429\ub2c8\ub2e4.", "section": "4 Experiments"}, {"content": "| Description | Small-scale | Large-scale |\n|---|---|---|\n| optimizer | AdamW | AdamW |\n| \\(\\beta_{1}\\) | 0.9 | 0.9 |\n| \\(\\beta_{2}\\) | 0.95 | 0.95 |\n| \\(\\epsilon\\) | 1e-8 | 1e-8 |\n| weight decay | 0.1 | 0.1 |\n| gradient clipping | 1.0 | 1.0 |\n| dropout | 0.0 | 0.0 |\n| weight tying | true | true |\n| vocab size | 50304 | 50304 |\n| learning rate schedule | cosine decay | cosine decay |\n| layer normalization | LayerNorm | LayerNorm |\n| precision | BF16 | BF16 |\n| hidden activation | GeLU | SwiGLU |\n| positional embedding | absolute (learned) | RoPE |\n| sequence length | 1024 | 2048 |\n| batch size (samples) | 96 | 256 |\n| batch size (tokens) | \\(\\sim\\)100k | \\(\\sim\\)500k |\n| warmup | 100 steps | 1\\% of steps |\n| training framework | nanoGPT | Modalities |\n| training parallelism | DDP | FSDP |", "caption": "Algorithm 2  Pseudocode for the SGD algorithm with optional momentum, applied to the embedding vectors eisubscript\ud835\udc52\ud835\udc56e_{i}italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT.", "description": "\uc54c\uace0\ub9ac\uc998 2\ub294 \uc784\ubca0\ub529 \ubca1\ud130\uc5d0 \uc801\uc6a9\ub418\ub294 \uc120\ud0dd\uc801 \ubaa8\uba58\ud140\uc744 \uac16\ub294 SGD \uc54c\uace0\ub9ac\uc998\uc758 \uc758\uc0ac \ucf54\ub4dc\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  \uc774 \ud45c\ub294 SGD \uc54c\uace0\ub9ac\uc998\uc758 \uac01 \ub2e8\uacc4(\uc785\ub825, \ucd08\uae30 \uc784\ubca0\ub529, \ubaa9\uc801 \ud568\uc218, \ubaa8\uba58\ud140, \uc2dc\uac04 \ub2e8\uacc4, \ucd9c\ub825)\ub97c \uc124\uba85\ud558\uace0, \ubaa8\uba58\ud140\uc744 \uc0ac\uc6a9\ud558\ub294 \ubc29\ubc95\uacfc \uc784\ubca0\ub529 \ubca1\ud130\ub97c \uc5c5\ub370\uc774\ud2b8\ud558\ub294 \ubc29\ubc95\uc744 \uc790\uc138\ud558\uac8c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \uc774\ub294 \ub17c\ubb38\uc5d0\uc11c \uc81c\uc2dc\ub41c Coupled Adam \uc54c\uace0\ub9ac\uc998\uacfc \ube44\uad50\ud558\uc5ec SGD \uc54c\uace0\ub9ac\uc998\uc758 \uc791\ub3d9 \ubc29\uc2dd\uc744 \uc774\ud574\ud558\ub294 \ub370 \ub3c4\uc6c0\uc774 \ub429\ub2c8\ub2e4.", "section": "2.2 Embedding Gradient \uc18c\uba78"}, {"content": "| N | lr | heads | layers | emb. dim. |\n|---|---|---|---|---|\n| 124M | 6.0e-4 | 12 | 12 | 768 |\n| 350M | 3.0e-4 | 16 | 24 | 1024 |\n| 760M | 2.5e-4 | 16 | 24 | 1536 |\n| 1.3B | 2.0e-4 | 32 | 24 | 2048 |\n| 2.6B | 1.6e-4 | 32 | 32 | 2560 |", "caption": "Table 5: General hyperparameters used in our two sets of experiments.", "description": "\ud45c 5\ub294 \ubcf8 \ub17c\ubb38\uc5d0\uc11c \uc218\ud589\ub41c \ub450 \uac00\uc9c0 \uc720\ud615\uc758 \uc2e4\ud5d8(\uc18c\uaddc\ubaa8 \ubc0f \ub300\uaddc\ubaa8 \uc2e4\ud5d8)\uc5d0 \uc0ac\uc6a9\ub41c \uc77c\ubc18\uc801\uc778 \ud558\uc774\ud37c\ud30c\ub77c\ubbf8\ud130\ub4e4\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  \ud45c\uc5d0\ub294 \ucd5c\uc801\ud654\uae30, \ubca0\ud0c0 \uac12, \uac00\uc911\uce58 \uac10\uc18c, \uadf8\ub798\ub514\uc5b8\ud2b8 \ud074\ub9ac\ud551, \ub4dc\ub86d\uc544\uc6c3, \uac00\uc911\uce58 \uc5f0\uacb0, \uc5b4\ud718 \ud06c\uae30, \ud559\uc2b5\ub960 \uc2a4\ucf00\uc904, \ub808\uc774\uc5b4 \uc815\uaddc\ud654, \uc815\ubc00\ub3c4, \uc740\ub2c9 \ud65c\uc131\ud654 \ud568\uc218, \uc704\uce58 \uc784\ubca0\ub529, \uc2dc\ud000\uc2a4 \uae38\uc774, \ubc30\uce58 \ud06c\uae30(\uc0d8\ud50c \ubc0f \ud1a0\ud070), \uc6cc\ubc0d\uc5c5, \ud559\uc2b5 \ud504\ub808\uc784\uc6cc\ud06c, \ubcd1\ub82c \ud559\uc2b5 \ub4f1 \ub2e4\uc591\ud55c \ud558\uc774\ud37c\ud30c\ub77c\ubbf8\ud130\ub4e4\uc774 \ud3ec\ud568\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4. \uc18c\uaddc\ubaa8 \uc2e4\ud5d8\uacfc \ub300\uaddc\ubaa8 \uc2e4\ud5d8\uc5d0 \ub530\ub77c \uc77c\ubd80 \ud558\uc774\ud37c\ud30c\ub77c\ubbf8\ud130 \uac12\uc774 \ub2e4\ub974\uac8c \uc124\uc815\ub418\uc5c8\uc74c\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.", "section": "4 Experiments"}, {"content": "| D | N | Optimizer | \\mathcal{L} (\\downarrow) | \\rm Acc (\\uparrow) | \\rm Iso (\\uparrow) | \\|\\mu\\| (\\downarrow) | \\|\\mu\\|\\rm r (\\downarrow) | \\overline{r} (\\uparrow) | \\rho (\\uparrow) | \\kappa (\\uparrow) |\n|---|---|---|---|---|---|---|---|---|---|---|---|\n| \\resultsAblationsSGDExpFive |  |  |  |  |  |  |  |  |  |  | ", "caption": "Table 6: Model-size dependent hyperparameter used in our experiments. N\ud835\udc41Nitalic_N denotes the model size in terms of parameters, while lr corresponds to the maximum learning rate.", "description": "\ud45c 6\uc740 \ub17c\ubb38\uc5d0\uc11c \uc0ac\uc6a9\ub41c \ubaa8\ub378 \ud06c\uae30\uc5d0 \ub530\ub978 \ud558\uc774\ud37c\ud30c\ub77c\ubbf8\ud130\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  N\uc740 \ubaa8\ub378\uc758 \ud30c\ub77c\ubbf8\ud130 \uc218\ub97c \ub098\ud0c0\ub0b4\uace0, lr\uc740 \ucd5c\ub300 \ud559\uc2b5\ub960\uc744 \uc758\ubbf8\ud569\ub2c8\ub2e4.  \ud45c\uc5d0\ub294 \ubaa8\ub378 \ud06c\uae30(N)\uac00 \uc99d\uac00\ud568\uc5d0 \ub530\ub77c \ucd5c\ub300 \ud559\uc2b5\ub960(lr)\uc744 \ube44\ub86f\ud55c \ub2e4\uc591\ud55c \ud558\uc774\ud37c\ud30c\ub77c\ubbf8\ud130\ub4e4\uc774 \uc5b4\ub5bb\uac8c \uc870\uc815\ub418\uc5c8\ub294\uc9c0\ub97c \ubcf4\uc5ec\uc8fc\ub294 \uc815\ubcf4\uac00 \ub2f4\uaca8\uc788\uc2b5\ub2c8\ub2e4. \uc774\ub294 \ubaa8\ub378 \ud06c\uae30 \ubcc0\ud654\uc5d0 \ub530\ub978 \ud559\uc2b5 \uacfc\uc815\uc758 \uc548\uc815\uc131 \ubc0f \ud6a8\uc728\uc131\uc744 \uc720\uc9c0\ud558\uae30 \uc704\ud55c \ud558\uc774\ud37c\ud30c\ub77c\ubbf8\ud130 \uc870\uc815 \uc804\ub7b5\uc744 \uc774\ud574\ud558\ub294 \ub370 \ub3c4\uc6c0\uc744 \uc90d\ub2c8\ub2e4.", "section": "E.2 Training Hyperparameters"}, {"content": "| D | N | Optimizer | \\mathcal{L} (\\downarrow) | \\rm Acc (\\uparrow) | \\rm Iso (\\uparrow) | \\|\\mu\\| (\\downarrow) | \\|\\mu\\|<sup>\\rm r</sup> (\\downarrow) | \\overline{r} (\\uparrow) | \\rho (\\uparrow) | \\kappa (\\uparrow) |\n|---|---|---|---|---|---|---|---|---|---|---|---|\n| \\resultsAblationsSGDExpTen |  |  |  |  |  |  |  |  |  |  |  |", "caption": "Table 7: Results of our experiments with SGD. Values are highlighted in bold if they are significantly better than all the other values in the same column.", "description": "\ud45c 7\uc740 \uc784\ubca0\ub529\uc5d0 \ub300\ud55c \ucd5c\uc801\ud654 \uae30\ubc95\uc73c\ub85c SGD(\ud655\ub960\uc801 \uacbd\uc0ac \ud558\uac15\ubc95)\ub97c \uc0ac\uc6a9\ud55c \uc2e4\ud5d8 \uacb0\uacfc\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  \ub2e4\uc591\ud55c \ubaa8\ub378 \ud06c\uae30(N)\uc640 \ub370\uc774\ud130\uc14b \ud06c\uae30(D)\uc5d0 \ub300\ud574, \ud45c\uc900 Adam\uacfc Coupled Adam\uc744 \uc0ac\uc6a9\ud55c \uacb0\uacfc\uc640 \ube44\uad50\ud558\uc5ec \uc190\uc2e4(L), \uc815\ud655\ub3c4(Acc), \ub4f1\ubc29\uc131(Iso), \ud3c9\uade0 \uc784\ubca0\ub529 \ubca1\ud130 \ud06c\uae30(||\u00b5||), \ud3c9\uade0 \uc784\ubca0\ub529 \ubca1\ud130 \ud06c\uae30\uc758 \ube44\uc728(||\u00b5||/||e||), \uc0c1\uad00\uad00\uacc4(p), \uc870\uac74\uc218(\u03ba) \ub4f1 \ub2e4\uc591\ud55c \uc9c0\ud45c\ub97c \uce21\uc815\ud588\uc2b5\ub2c8\ub2e4.  \uac19\uc740 \uc5f4\uc758 \ub2e4\ub978 \uac12\ub4e4\ubcf4\ub2e4 \ud1b5\uacc4\uc801\uc73c\ub85c \uc720\uc758\ubbf8\ud558\uac8c \ub354 \uc88b\uc740 \uac12\uc744 \uac00\uc9c0\ub294 \uacbd\uc6b0 \uad75\uc740 \uae00\uc528\uccb4\ub85c \ud45c\uc2dc\ud588\uc2b5\ub2c8\ub2e4. \uc774\ub97c \ud1b5\ud574, SGD\uc640 Coupled Adam\uc758 \uc131\ub2a5\uc744 \ube44\uad50\ubd84\uc11d\ud558\uace0, \uc784\ubca0\ub529 \ud488\uc9c8\uc5d0 \ubbf8\uce58\ub294 \uc601\ud5a5\uc744 \ub2e4\uac01\uc801\uc73c\ub85c \ud3c9\uac00\ud558\uc5ec \ucd5c\uc801\uc758 \uc784\ubca0\ub529 \uc804\ub7b5\uc744 \uc81c\uc2dc\ud558\uace0\uc790 \ud588\uc2b5\ub2c8\ub2e4.", "section": "4 Experiments"}]