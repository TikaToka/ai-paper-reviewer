<br><table id='5' style='font-size:18px'><tr><td>Input: dataset D with F⌀ , weighting w⌀, learning rate 7, proposal iteration H.</td><td>std. ⌀d, pretrained diffusion model Fpretrain with parameter Opretrain, model (Pmean, Pstd), constant c, warmup</td></tr><tr><td>Init: 0 ← Opretrain, Iters ← 0.</td><td></td></tr><tr><td>repeat X⌀ ~ D, z ~ N(0,0oJ), T ~ N(Pmean, Pstd), t arctan(�), cos(t)xo + sin (t)z</td><td>Xt ←</td></tr><tr><td>← dxt cos(t)z - sin(t)xo if consistency training else dxt ← dt</td><td>← ⌀d Fpretrain (ort , t) dt</td></tr><tr><td>r ← min(1, Iters/H)</td><td>▷ Tangent warmup )</td></tr><tr><td>g ← - cos2(t)(�dF�- - dact ) - r · cos(t) sin(t)(xt + ⌀d dFat rearrangement ← g/(llgll +</td><td>▷ JVP ▷</td></tr><tr><td>g c) Tangent normalization</td><td></td></tr><tr><td>L(�,⌀) ← ew⌀(t) IIFe(�,t) - Fe-(⌀,t) - gll2 - w⌀(t) Adaptive weighting (�, ⌀) ←</td><td>▷</td></tr><tr><td>(�, ⌀) - 700,⌀L(0, ⌀)</td><td></td></tr><tr><td>Iters Iters +1</td><td></td></tr><tr><td>← until convergence</td><td></td></tr></table>