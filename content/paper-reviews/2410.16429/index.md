---
title: "Pantograph: A Machine-to-Machine Interaction Interface for Advanced Theorem Proving, High Level Reasoning, and Data Extraction in Lean 4"
summary: "Pantograph: A new Lean 4 interface boosts machine-assisted theorem proving via efficient search and high-level reasoning, opening avenues for advanced ML models."
categories: ["AI Generated"]
tags: ["ðŸ”– 24-10-21", "ðŸ¤— 24-10-25"]
showSummary: true
date: 2024-10-21
draft: false
---

### TL;DR


{{< lead >}}

Pantograph is a new tool designed to improve how machine learning interacts with the Lean 4 proof assistant.  It provides a better interface than existing systems, allowing machine learning models to more effectively search for and construct mathematical proofs.  Key improvements include support for advanced reasoning steps, more robust handling of complex search scenarios, and efficient extraction of data for training machine learning models.  The authors demonstrate the tool's effectiveness by implementing the 'Draft-Sketch-Proof' approach in Lean 4, a method that first generates a high-level proof outline and then fills in the details. Their experiments show that this approach, using large language models, achieves a notable success rate in proving theorems from the MiniF2F benchmark.

{{< /lead >}}


{{< button href="https://arxiv.org/abs/2410.16429" target="_self" >}}
{{< icon "link" >}} &nbsp; read the paper on arXiv
{{< /button >}}

#### Why does it matter?
Pantograph is a novel machine-to-machine interface for Lean 4, enabling efficient proof search and high-level reasoning, paving the way for more advanced machine learning models in theorem proving.
#### Key Takeaways

{{< alert "star" >}}
{{< typeit speed=10 lifeLike=true >}} Pantograph offers a user-friendly interface for training and evaluating theorem-proving agents, overcoming limitations of existing interfaces. {{< /typeit >}}
{{< /alert >}}

{{< alert "star" >}}
{{< typeit speed=10 startDelay=1000 lifeLike=true >}} It supports various search algorithms (like Monte Carlo Tree Search), high-level reasoning tactics, and efficient data extraction for training. {{< /typeit >}}
{{< /alert >}}

{{< alert "star" >}}
{{< typeit speed=10 startDelay=2000 lifeLike=true >}} Pantograph enables the Draft-Sketch-Proof approach in Lean 4, showing promising results in automated theorem proving. {{< /typeit >}}
{{< /alert >}}

------
#### Visual Insights



![](figures/figures_5_0.png "ðŸ”¼ Fig. 1: A proof tree for Expression (1)")

> The figure shows a proof tree for the expression representing the commutativity of logical OR, illustrating the structure generated by applying tactics in a proof assistant.





![](charts/charts_14_0.png "ðŸ”¼ Fig. 6: Hammer invocations and runtimes of DSP on the validation and test sets of MiniF2F using the GPT-40 model. The name of the legend refers to the dataset split (validation or test) and the number of sketches used to solve the dataset split.")

> Figure 6 shows the distribution of the number of hammer tactic invocations and the distribution of runtimes for the DSP experiment on the validation and test sets of the MiniF2F dataset using the GPT-40 model.





{{< table-caption caption="ðŸ”½ Table 1: LLM parameters for DSP Experiment" >}}
<table id='4' style='font-size:16px'><tr><td>Parameter</td><td>Value</td></tr><tr><td>Max tokens</td><td>2048</td></tr><tr><td>Top P</td><td>0.95</td></tr><tr><td>Temperature</td><td>0.8</td></tr></table>{{< /table-caption >}}

> The table lists the maximum number of tokens, top P, and temperature values used for both the GPT-4 and GPT-01-preview language models in the DSP experiment.



### More visual insights

<details>
<summary>More on figures
</summary>


![](figures/figures_7_0.png "ðŸ”¼ Fig. 2: System architecture of Pantograph. A solid arrow indicates that the component at the arrow source calls functions in the component that is the arrow's target. A human operator interacts with Lean 4's kernel via the IDE, but a machine learning agent can interact via one of Pantograph's interfaces.")

> The figure illustrates the system architecture of Pantograph, showing how machine learning agents and human operators interact with the Lean 4 kernel via different interfaces.


![](figures/figures_7_1.png "ðŸ”¼ Fig. 3: Call hierarchy in Pantograph during the execution of a normal tactic. The text on the right indicates the Lean 4 monad each function runs in.")

> The figure shows the call hierarchy of functions in Pantograph during the execution of a tactic, indicating the Lean 4 monad each function runs in.


![](figures/figures_10_0.png "ðŸ”¼ Fig. 4: 2 becomes dormant after a tactic is applied to 1. It must be brought back into scope with goal.continue before the proof can finish. The ellipses (...) are plalceholders for some combination of tactics which eventually solves the descendant of 1")

> The figure illustrates how a goal becomes dormant in Pantograph when using manual tree search and how to bring it back into scope using the goal.continue command.


![](figures/figures_11_0.png "ðŸ”¼ Fig. 5: In this diagram, rectangular boxes are proof states, and circles are goals. Each proof state has 0 or more goals. A state with no goals is considered solved. If all descendant goals of a state become solved, the state itself becomes solved.")

> The figure illustrates the workflow of metavariable coupling in Pantograph, showing how goals are solved sequentially and how dormant goals are handled.


</details>




### Full paper

{{< gallery >}}
<img src="paper_images/1.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/2.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/3.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/4.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/5.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/6.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/7.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/8.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/9.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/10.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/11.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/12.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/13.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/14.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/15.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/16.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/17.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/18.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
{{< /gallery >}}