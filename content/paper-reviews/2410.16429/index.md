---
title: "Pantograph: A Machine-to-Machine Interaction Interface for Advanced Theorem Proving, High Level Reasoning, and Data Extraction in Lean 4"
summary: "Pantograph boosts machine-assisted theorem proving by creating a seamless Lean 4 interface for efficient proof search and high-level reasoning, facilitating advanced AI model training."
categories: ["AI Generated"]
tags: ["ðŸ”– 24-10-21", "ðŸ¤— 24-10-25"]
showSummary: true
date: 2024-10-21
draft: false
---

### TL;DR


{{< lead >}}

Pantograph is a new tool designed to bridge the gap between machine learning and automated theorem proving using the Lean 4 proof assistant.  It improves the efficiency and effectiveness of proof search by providing a more intuitive interface than existing methods.  This interface allows for the use of advanced reasoning strategies and sophisticated search algorithms. Importantly, Pantograph facilitates the extraction of valuable data for training and improving machine learning models for theorem proving. This data includes complete proof scripts, tactic execution details, and program-like representations of proofs.  The authors demonstrate the effectiveness of Pantograph by applying it to the Draft-Sketch-Proof (DSP) approach, a method for theorem proving that combines high-level reasoning with detailed verification, and achieving a 28% success rate on a benchmark dataset without specialized training. Pantograph's contributions are significant because it addresses the limitations of current interfaces, supports more powerful search algorithms, and provides tools for extracting valuable data, paving the way for future advancements in machine-assisted theorem proving.

{{< /lead >}}


{{< button href="https://arxiv.org/abs/2410.16429" target="_self" >}}
{{< icon "link" >}} &nbsp; read the paper on arXiv
{{< /button >}}

#### Why does it matter?
Pantograph is a novel tool that improves the interaction between machine learning models and the Lean 4 proof assistant, enabling more efficient proof search and high-level reasoning.  It offers a user-friendly interface, supports advanced reasoning steps, and facilitates data extraction for training machine learning models.
#### Key Takeaways

{{< alert "star" >}}
{{< typeit speed=10 lifeLike=true >}} Pantograph provides a user-friendly interface for machine learning agents to interact with Lean 4, overcoming limitations of the existing Language Server Protocol. {{< /typeit >}}
{{< /alert >}}

{{< alert "star" >}}
{{< typeit speed=10 startDelay=1000 lifeLike=true >}} It supports advanced reasoning steps and efficient search algorithms like Monte Carlo Tree Search, improving proof search efficiency. {{< /typeit >}}
{{< /alert >}}

{{< alert "star" >}}
{{< typeit speed=10 startDelay=2000 lifeLike=true >}} Pantograph enables crucial data extraction for training machine learning models, including extracting entire proof scripts and their representations as programs. {{< /typeit >}}
{{< /alert >}}

------
#### Visual Insights



![](figures/figures_5_0.png "ðŸ”¼ Fig. 1: A proof tree for Expression (1)")

> The figure shows a proof tree for the expression representing the commutativity of logical OR, illustrating the structure generated by applying tactics in a proof assistant.





![](charts/charts_14_0.png "ðŸ”¼ Fig. 6: Hammer invocations and runtimes of DSP on the validation and test sets of MiniF2F using the GPT-40 model. The name of the legend refers to the dataset split (validation or test) and the number of sketches used to solve the dataset split.")

> Figure 6 shows the distribution of the number of hammer tactic invocations and the distribution of runtimes for the DSP experiment on the validation and test sets of the MiniF2F dataset using the GPT-40 model.





{{< table-caption caption="ðŸ”½ Table 1: LLM parameters for DSP Experiment" >}}
<table id='4' style='font-size:16px'><tr><td>Parameter</td><td>Value</td></tr><tr><td>Max tokens</td><td>2048</td></tr><tr><td>Top P</td><td>0.95</td></tr><tr><td>Temperature</td><td>0.8</td></tr></table>{{< /table-caption >}}

> The table lists the maximum number of tokens, top P, and temperature values used for both the GPT-4 and GPT-01-preview language models in the DSP experiment.



### More visual insights

<details>
<summary>More on figures
</summary>


![](figures/figures_7_0.png "ðŸ”¼ Fig. 2: System architecture of Pantograph. A solid arrow indicates that the component at the arrow source calls functions in the component that is the arrow's target. A human operator interacts with Lean 4's kernel via the IDE, but a machine learning agent can interact via one of Pantograph's interfaces.")

> The figure illustrates the system architecture of Pantograph, showing how machine learning agents and human operators interact with the Lean 4 kernel via different interfaces.


![](figures/figures_7_1.png "ðŸ”¼ Fig. 3: Call hierarchy in Pantograph during the execution of a normal tactic. The text on the right indicates the Lean 4 monad each function runs in.")

> The figure shows the call hierarchy of functions in Pantograph during the execution of a tactic, indicating the Lean 4 monad each function runs in.


![](figures/figures_10_0.png "ðŸ”¼ Fig. 4: 2 becomes dormant after a tactic is applied to 1. It must be brought back into scope with goal.continue before the proof can finish. The ellipses (...) are plalceholders for some combination of tactics which eventually solves the descendant of 1")

> The figure illustrates how a goal becomes dormant in Pantograph when using manual tree search and how to bring it back into scope using the goal.continue command.


![](figures/figures_11_0.png "ðŸ”¼ Fig. 5: In this diagram, rectangular boxes are proof states, and circles are goals. Each proof state has 0 or more goals. A state with no goals is considered solved. If all descendant goals of a state become solved, the state itself becomes solved.")

> The figure illustrates the workflow of metavariable coupling in Pantograph, showing how goals are solved sequentially and how dormant goals are handled.


</details>




### Full paper

{{< gallery >}}
<img src="paper_images/1.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/2.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/3.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/4.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/5.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/6.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/7.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/8.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/9.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/10.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/11.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/12.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/13.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/14.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/15.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/16.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/17.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
<img src="paper_images/18.png" class="grid-w50 md:grid-w33 xl:grid-w25" />
{{< /gallery >}}