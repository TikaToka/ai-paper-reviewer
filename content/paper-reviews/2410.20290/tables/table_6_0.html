<br><table id='1' style='font-size:14px'><tr><td>Input:</td><td>An auto-regressive generative model p, a reward model S, stopping fraction a E (0,1), a prompt X.</td></tr><tr><td>1:</td><td>Decide the initial batch size as binit based on the GPU memory capacity and the prompt length.</td></tr><tr><td>2:</td><td>b ← binit, I = ⌀. b ></td></tr><tr><td>3:</td><td>while 0 do For 1 ≤ k ≤ b, generate (Y1 , Yk2 , . ", Yk) from model</td></tr><tr><td>4:</td><td>p and Tk := min{�, lk}, where Tk is the number of generated tokens before OOM and lk is the number of tokens in Yk.</td></tr><tr><td>5:</td><td>Evaluate all partial rewards from s and compute the cutoff threshold via</td></tr><tr><td>6:</td><td>Compute the set of accepted index Iaccepted via add completed sequences to I.</td></tr><tr><td>7:</td><td>Update the batch size using Iaccepted: b ← |Zaccepted|.</td></tr><tr><td>8:</td><td>end while</td></tr><tr><td>Output:</td><td>YSR = Yk* with k* = arg maxkET s(Yk).</td></tr></table>