[{"figure_path": "https://arxiv.org/html/2502.12574/x1.png", "caption": "Figure 1: Estimated memory consumption of inference a Llama-3-8B model with 1 million token on a single GPU.", "description": "\uadf8\ub9bc 1\uc740 \ub2e8\uc77c GPU\uc5d0\uc11c 100\ub9cc \ud1a0\ud070\uc744 \uc0ac\uc6a9\ud558\uc5ec Llama-3-8B \ubaa8\ub378 \ucd94\ub860 \uc2dc \uc608\uc0c1\ub418\ub294 \uba54\ubaa8\ub9ac \uc18c\ube44\ub7c9\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  Llama-3-8B \ubaa8\ub378\uc758 \ucd94\ub860 \uacfc\uc815\uc5d0\uc11c \uac00\uc911\uce58, \ud65c\uc131\ud654 \ubc0f KV \uce90\uc2dc\uc758 \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub7c9\uc744 \uac01\uac01 \ub098\ud0c0\ub0c5\ub2c8\ub2e4.  \ucee8\ud14d\uc2a4\ud2b8 \uae38\uc774\uac00 \uc99d\uac00\ud568\uc5d0 \ub530\ub77c KV \uce90\uc2dc\uc758 \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub7c9\uc774 \uae30\ud558\uae09\uc218\uc801\uc73c\ub85c \uc99d\uac00\ud558\ub294 \uac83\uc744 \ubcf4\uc5ec\uc8fc\uc5b4,  \uc7a5\ubb38 \ucee8\ud14d\uc2a4\ud2b8 \ucc98\ub9ac\uc5d0 \uc5b4\ub824\uc6c0\uc744 \uacaa\ub294 \uac83\uc744 \uc2dc\uac01\uc801\uc73c\ub85c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  \ud2b9\ud788, KV \uce90\uc2dc\uac00 \uc804\uccb4 \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub7c9\uc758 \uc0c1\ub2f9 \ubd80\ubd84\uc744 \ucc28\uc9c0\ud558\uba70, \uc774\ub294 \uc7a5\ubb38 \ucee8\ud14d\uc2a4\ud2b8 \ucc98\ub9ac\ub97c \uc704\ud55c GPU \uba54\ubaa8\ub9ac \uc81c\uc57d\uc758 \uc2ec\uac01\uc131\uc744 \uac15\uc870\ud569\ub2c8\ub2e4.", "section": "1. Introduction"}, {"figure_path": "https://arxiv.org/html/2502.12574/x2.png", "caption": "Figure 2: Demonstrations of KV cache policies in inference. Full KV cache contains two main dimensions: layer and head. Layer-wise offloads KV cache in the layer\u2019s dimension, with a cache budget of all heads per layer. HeadInfer further reduces GPU memory by adaptively reallocating cache budgets in the head\u2019s dimension, with a cache budget of one head.", "description": "\uadf8\ub9bc 2\ub294 Transformer \ubaa8\ub378 \ucd94\ub860 \uc2dc Key-Value(KV) \uce90\uc2dc \uad00\ub9ac \uc804\ub7b5\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. KV \uce90\uc2dc\ub294 \uacc4\uce35(Layer)\uacfc \ud5e4\ub4dc(Head) \ub450 \uac00\uc9c0 \ucc28\uc6d0\uc73c\ub85c \uad6c\uc131\ub429\ub2c8\ub2e4.  \uae30\uc874\uc758 \uacc4\uce35\ubcc4 \uc624\ud504\ub85c\ub529(Layer-wise offloading) \ubc29\ubc95\uc740 \uac01 \uacc4\uce35\uc758 KV \uce90\uc2dc \uc804\uccb4\ub97c GPU \uba54\ubaa8\ub9ac\uc5d0\uc11c CPU \uba54\ubaa8\ub9ac\ub85c \uc774\ub3d9\uc2dc\ud0a4\ub294 \ubc29\uc2dd\uc785\ub2c8\ub2e4. \uc774\ub54c \uac01 \uacc4\uce35\uc740 \ubaa8\ub4e0 \ud5e4\ub4dc\uc758 KV \uce90\uc2dc\ub97c \uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 \ud560\ub2f9\ub7c9\uc744 \uac16\uc2b5\ub2c8\ub2e4. \ubc18\uba74 HeadInfer\ub294 \uc774\ubcf4\ub2e4 \ub354\uc6b1 \ud6a8\uc728\uc801\uc778 \uba54\ubaa8\ub9ac \uad00\ub9ac\ub97c \uc704\ud574 \ud5e4\ub4dc\ubcc4 \uc624\ud504\ub85c\ub529(Head-wise offloading) \uc804\ub7b5\uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4. HeadInfer\ub294 \ud2b9\uc815 \uc2dc\uc810\uc5d0 GPU \uba54\ubaa8\ub9ac\uc5d0 \ub2e8 \ud558\ub098\uc758 \ud5e4\ub4dc KV \uce90\uc2dc\ub9cc \uc800\uc7a5\ud558\uace0 \ub098\uba38\uc9c0\ub294 CPU \uba54\ubaa8\ub9ac\uc5d0 \uc800\uc7a5\ud558\ub294 \ubc29\uc2dd\uc785\ub2c8\ub2e4. \uc774\ub807\uac8c \ud558\uba74 \ud544\uc694\uc5d0 \ub530\ub77c \ud5e4\ub4dc \ub2e8\uc704\ub85c \ub3d9\uc801\uc73c\ub85c KV \uce90\uc2dc\ub97c \ud560\ub2f9\ud558\uace0 \uad00\ub9ac\ud558\uc5ec GPU \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub7c9\uc744 \ucd5c\uc18c\ud654\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.", "section": "3. HEADINFER: Head-wise Offload"}, {"figure_path": "https://arxiv.org/html/2502.12574/x3.png", "caption": "Figure 3: Granularity of different methods. Each cube represents the entire attention process along three dimensions: Sequence (S), Layers (L), and Heads (H). Standard inference puts everything on the GPU.\nChunked-prefill fetches only a part of the sequence dimension of all tokens on the GPU at a time.\nLayer-wise offloading fetches a subset of layers on the GPU, offloading the rest.\nHeadInfer introduces an even finer approach that maintains only selected heads within a layer.", "description": " \uadf8\ub9bc 3\uc740 \ub2e4\uc591\ud55c \ucd94\ub860 \ubc29\ubc95\ub4e4\uc758 \uc138\ubd84\uc131(granularity)\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \uac01 \ud050\ube0c\ub294 \uc2dc\ud000\uc2a4(S), \ub808\uc774\uc5b4(L), \ud5e4\ub4dc(H)\uc758 \uc138 \uac00\uc9c0 \ucc28\uc6d0\uc744 \ub530\ub77c \uc804\uccb4 \uc5b4\ud150\uc158 \ud504\ub85c\uc138\uc2a4\ub97c \ub098\ud0c0\ub0c5\ub2c8\ub2e4. \ud45c\uc900 \ucd94\ub860\uc740 \ubaa8\ub4e0 \uac83\uc744 GPU\uc5d0 \ubc30\uce58\ud569\ub2c8\ub2e4. \uccad\ud06c \uc0ac\uc804 \ucc44\uc6b0\uae30(chunked prefill)\ub294 \ud55c \ubc88\uc5d0 \ubaa8\ub4e0 \ud1a0\ud070\uc758 \uc2dc\ud000\uc2a4 \ucc28\uc6d0\uc758 \uc77c\ubd80\ub9cc GPU\uc5d0\uc11c \uac00\uc838\uc635\ub2c8\ub2e4. \ub808\uc774\uc5b4\ubcc4 \uc624\ud504\ub85c\ub529(layer-wise offloading)\uc740 GPU\uc5d0\uc11c \ub808\uc774\uc5b4\uc758 \ud558\uc704 \uc9d1\ud569\uc744 \uac00\uc838\uc624\uace0 \ub098\uba38\uc9c0\ub294 \uc624\ud504\ub85c\ub529\ud569\ub2c8\ub2e4. HeadInfer\ub294 \ub808\uc774\uc5b4 \ub0b4\uc5d0\uc11c \uc120\ud0dd\ub41c \ud5e4\ub4dc\ub9cc \uc720\uc9c0\ud558\ub294 \ub354\uc6b1 \uc138\ubd84\ud654\ub41c \uc811\uadfc \ubc29\uc2dd\uc744 \uc81c\uc2dc\ud569\ub2c8\ub2e4. \uc774 \uadf8\ub9bc\uc740 GPU \uba54\ubaa8\ub9ac \uc81c\uc57d \uc870\uac74 \ud558\uc5d0\uc11c \uc7a5\ubb38 \ucee8\ud14d\uc2a4\ud2b8 \ucd94\ub860\uc758 \ud6a8\uc728\uc131\uc744 \ub192\uc774\uae30 \uc704\ud55c \ub2e4\uc591\ud55c \ubc29\ubc95\uc758 \ucc28\uc774\uc810\uc744 \uc2dc\uac01\uc801\uc73c\ub85c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.", "section": "3. HEADINFER: Head-wise Offload"}, {"figure_path": "https://arxiv.org/html/2502.12574/x4.png", "caption": "Figure 4: HeadInfer snapshot. All parameters are stored on the GPU. Head-wise partitioned KV cache is moved across GPU and CPU with the ping-pong memory.", "description": "\uadf8\ub9bc 4\ub294 HEADINFER\uc758 \uba54\ubaa8\ub9ac \uad00\ub9ac \uc804\ub7b5\uc744 \ubcf4\uc5ec\uc8fc\ub294 \uc2a4\ub0c5\uc0f7\uc785\ub2c8\ub2e4. \ubaa8\ub378\uc758 \ubaa8\ub4e0 \ud30c\ub77c\ubbf8\ud130\ub294 GPU\uc5d0 \uc800\uc7a5\ub418\uace0,  Key-Value \uce90\uc2dc(KV \uce90\uc2dc)\ub294 \ud5e4\ub4dc \ub2e8\uc704\ub85c \ubd84\ud560\ub418\uc5b4 GPU\uc640 CPU \uac04\uc5d0 \ud551\ud401 \uba54\ubaa8\ub9ac\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc774\ub3d9\ud569\ub2c8\ub2e4.  \uc774\ub294 GPU \uba54\ubaa8\ub9ac\uc758 \uc81c\ud55c\uc744 \uadf9\ubcf5\ud558\uace0, \uc7a5\uae30 \ucee8\ud14d\uc2a4\ud2b8 \ucd94\ub860\uc744 \uc704\ud55c \ud6a8\uc728\uc801\uc778 \uba54\ubaa8\ub9ac \uad00\ub9ac \uc804\ub7b5\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  \ud2b9\ud788, \ud2b9\uc815 \ud5e4\ub4dc\uc758 KV \uce90\uc2dc\ub9cc GPU\uc5d0 \uc720\uc9c0\ud558\uace0 \ub098\uba38\uc9c0\ub294 CPU\ub85c \uc774\ub3d9\uc2dc\ucf1c, GPU \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub7c9\uc744 \ud06c\uac8c \uc904\uc785\ub2c8\ub2e4. \ub3d9\uc2dc\uc5d0, \ube44\ub3d9\uae30\uc2dd \ub370\uc774\ud130 \uc804\uc1a1\uc744 \ud1b5\ud574 \uacc4\uc0b0 \ud6a8\uc728\uc131\uc744 \uc720\uc9c0\ud569\ub2c8\ub2e4.", "section": "4. HEADINFER\ub97c \uc0ac\uc6a9\ud55c \uba54\ubaa8\ub9ac \ud6a8\uc728\uc801\uc778 \ucd94\ub860"}, {"figure_path": "https://arxiv.org/html/2502.12574/x5.png", "caption": "Figure 5: Flashattention in the roofline plot analysis using the RTX-4090 device setting.", "description": "\uadf8\ub9bc 5\ub294 RTX 4090 GPU\ub97c \uc0ac\uc6a9\ud558\uc5ec FlashAttention \ucee4\ub110\uc758 \uc131\ub2a5\uc744 \ubd84\uc11d\ud55c Roofline plot\uc785\ub2c8\ub2e4. Roofline plot\uc740 GPU\uc758 \uacc4\uc0b0 \uc131\ub2a5\uacfc \uba54\ubaa8\ub9ac \ub300\uc5ed\ud3ed\uc744 \uace0\ub824\ud558\uc5ec, \uc5b4\ub5a4 \uc5f0\uc0b0\uc774 \uacc4\uc0b0 \uc81c\ud55c\uc801\uc778\uc9c0 \ub610\ub294 \uba54\ubaa8\ub9ac \uc81c\ud55c\uc801\uc778\uc9c0\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \uc774 \uadf8\ub9bc\uc740 prefill \ubc0f decoding \ub2e8\uacc4\uc5d0\uc11c \uac01\uac01\uc758 \uc5b4\ub5a4 \ub3d9\uc791\uc774 \uacc4\uc0b0 \uc81c\ud55c\uc801\uc778\uc9c0 \ub610\ub294 \uba54\ubaa8\ub9ac \uc81c\ud55c\uc801\uc778\uc9c0, \uadf8\ub9ac\uace0 HEADINFER\uac00 \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub7c9\uc744 \uc904\uc774\uba74\uc11c\ub3c4 \uacc4\uc0b0 \ud6a8\uc728\uc744 \uc720\uc9c0\ud558\ub294\uc9c0 \uc5ec\ubd80\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  x\ucd95\uc740 \uc5f0\uc0b0 \uac15\ub3c4(FLOP/Byte), y\ucd95\uc740 \uc131\ub2a5(TFLOP/s)\uc744 \ub098\ud0c0\ub0c5\ub2c8\ub2e4. \uc5ec\ub7ec \uac00\uc9c0 \ub2e4\ub978 \ubc29\ubc95(Baseline, Offload, HeadInfer)\uc758 prefill \ubc0f decoding \uc131\ub2a5\uc744 \ube44\uad50\ud558\uc5ec HEADINFER\uc758 \ud6a8\uc728\uc131\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  \ud2b9\ud788,  HEADINFER\ub294 \uae34 \ubb38\ub9e5 \uae38\uc774\uc5d0\uc11c\ub3c4 \uacc4\uc0b0 \ud6a8\uc728\uc131\uc744 \uc720\uc9c0\ud558\uba74\uc11c \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub7c9\uc744 \ud06c\uac8c \uc904\uc774\ub294 \uac83\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.", "section": "5. Analysis"}, {"figure_path": "https://arxiv.org/html/2502.12574/x6.png", "caption": "Figure 6: HeadInfer provides equal accuracy as standard inference on the Needle-in-a-Haystack benchmark", "description": "\uadf8\ub9bc 6\uc740 Needle-in-a-Haystack \ubca4\uce58\ub9c8\ud06c\uc5d0\uc11c HeadInfer\uac00 \ud45c\uc900 \ucd94\ub860\uacfc \ub3d9\uc77c\ud55c \uc815\ud655\ub3c4\ub97c \uc81c\uacf5\ud568\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \uc774 \uadf8\ub9bc\uc740 \ub2e4\uc591\ud55c \ubb38\ub9e5 \uae38\uc774\uc640 \ud558\ub4dc\uc6e8\uc5b4 \ud658\uacbd\uc5d0\uc11c HeadInfer\uc758 \uc131\ub2a5\uc744 \ud3c9\uac00\ud55c \uacb0\uacfc\ub97c \ubcf4\uc5ec\uc8fc\ub294 \uc5ec\ub7ec \uadf8\ub798\ud504\ub85c \uad6c\uc131\ub420 \uc218 \uc788\uc2b5\ub2c8\ub2e4.  \uac01 \uadf8\ub798\ud504\ub294 \ud2b9\uc815 \ubb38\ub9e5 \uae38\uc774\uc5d0 \ub300\ud55c HeadInfer\uc758 \uc815\ud655\ub3c4\ub97c \ud45c\uc900 \ucd94\ub860 \uacb0\uacfc\uc640 \ube44\uad50\ud558\uc5ec HeadInfer\uc758 \uc815\ud655\uc131\uc774 \ubb38\ub9e5 \uae38\uc774\uc5d0 \uc601\ud5a5\uc744 \ubc1b\uc9c0 \uc54a\uace0 \ud45c\uc900 \ucd94\ub860\uacfc \ub3d9\uc77c\ud568\uc744 \uc2dc\uac01\uc801\uc73c\ub85c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.", "section": "5. \ubd84\uc11d"}, {"figure_path": "https://arxiv.org/html/2502.12574/x7.png", "caption": "Figure 7: Token eviction methods cannot work when querying the less relevant information to the main theme. Here, we use a 10K document from LongBench (Bai et\u00a0al., 2023b) and add one sentence that is not relevant to the main theme. In this case, H2O discards tokens less relevant to the main theme, leading to error generation. StreamingLLM discards tokens based on the query but remaining question tokens, making it Hallucinations. HeadInfer can successfully output the exact information from the lengthy input, even when we compress 75% of the KV cache", "description": " \uadf8\ub9bc 7\uc740 \uc8fc\uc81c\uc640 \uad00\ub828\uc774 \uc5c6\ub294 \uc815\ubcf4\ub97c \uc9c8\uc758\ud560 \ub54c \ud1a0\ud070 \uc0ad\uc81c \ubc29\ubc95\uc774 \uc791\ub3d9\ud558\uc9c0 \uc54a\ub294\ub2e4\ub294 \uac83\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. LongBench(Bai et al., 2023b)\uc758 10K \ubb38\uc11c\ub97c \uc0ac\uc6a9\ud558\uace0 \uc8fc\uc81c\uc640 \uad00\ub828 \uc5c6\ub294 \ubb38\uc7a5 \ud558\ub098\ub97c \ucd94\uac00\ud588\uc2b5\ub2c8\ub2e4. H2O\ub294 \uc8fc\uc81c\uc640 \uad00\ub828 \uc5c6\ub294 \ud1a0\ud070\uc744 \uc0ad\uc81c\ud558\uc5ec \uc798\ubabb\ub41c \uacb0\uacfc\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4. StreamingLLM\uc740 \uc9c8\uc758\uc5d0 \ub530\ub77c \ud1a0\ud070\uc744 \uc0ad\uc81c\ud558\uc9c0\ub9cc \uc9c8\ubb38 \ud1a0\ud070\uc740 \ub0a8\uaca8\ub450\uc5b4 \ud658\uac01 \ud604\uc0c1\uc744 \uc720\ubc1c\ud569\ub2c8\ub2e4. HeadInfer\ub294 KV \uce90\uc2dc\uc758 75%\ub97c \uc555\ucd95\ud558\ub354\ub77c\ub3c4 \uae34 \uc785\ub825\uc5d0\uc11c \uc815\ud655\ud55c \uc815\ubcf4\ub97c \uc131\uacf5\uc801\uc73c\ub85c \ucd9c\ub825\ud569\ub2c8\ub2e4.", "section": "6. \uc131\ub2a5 \ud3c9\uac00"}, {"figure_path": "https://arxiv.org/html/2502.12574/x8.png", "caption": "Figure 8: Flashattention in the roofline plot analysis using A100 device setting.", "description": "\uadf8\ub9bc 8\uc740 A100 GPU\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc218\ud589\ud55c roofline \ubd84\uc11d \ud50c\ub86f\uc785\ub2c8\ub2e4. roofline \ubd84\uc11d\uc740 GPU\uc758 \uc131\ub2a5\uc744 \uc81c\ud55c\ud558\ub294 \uc694\uc18c(\uba54\ubaa8\ub9ac \ub300\uc5ed\ud3ed \ub610\ub294 \uacc4\uc0b0 \uc131\ub2a5)\ub97c \ud30c\uc545\ud558\ub294 \ub370 \uc0ac\uc6a9\ub418\ub294 \uc2dc\uac01\uc801 \ub3c4\uad6c\uc785\ub2c8\ub2e4. \uc774 \ud50c\ub86f\uc740 \ud50c\ub798\uc2dc \uc5b4\ud150\uc158(FlashAttention) \ucee4\ub110\uc758 \uacc4\uc0b0 \ucc98\ub9ac\ub7c9\uacfc \uc5f0\uc0b0 \uac15\ub3c4\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \uc774 \ubd84\uc11d\uc744 \ud1b5\ud574  A100 GPU\uc5d0\uc11c prefill\uacfc decoding \ub2e8\uacc4\uc758 \uc131\ub2a5\uc744 \uc81c\ud55c\ud558\ub294 \uc694\uc778\uc774 \ubb34\uc5c7\uc778\uc9c0, \uadf8\ub9ac\uace0 HEADINFER\uac00 \uc5b4\ub5bb\uac8c \uc774\ub7ec\ud55c \uc81c\uc57d\uc744 \uc644\ud654\ud558\ub294\uc9c0 \uc774\ud574\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.  x\ucd95\uc740 \uc5f0\uc0b0 \uac15\ub3c4(FLOP/\ubc14\uc774\ud2b8)\uc774\uace0 y\ucd95\uc740 \uc131\ub2a5(TFLOP/s)\uc785\ub2c8\ub2e4. \uac01 \uc120\uc740 \uba54\ubaa8\ub9ac \ub300\uc5ed\ud3ed\uacfc \uacc4\uc0b0 \uc131\ub2a5\uc758 \ud3ec\ud654 \ud55c\uacc4\ub97c \ub098\ud0c0\ub0c5\ub2c8\ub2e4. \ud50c\ub86f\uc758 \ub370\uc774\ud130 \ud3ec\uc778\ud2b8\ub294 prefill\uacfc decoding \uac01 \ub2e8\uacc4\uc758 \ud50c\ub798\uc2dc \uc5b4\ud150\uc158 \ucee4\ub110\uc758 \uc131\ub2a5\uc744 \ub098\ud0c0\ub0c5\ub2c8\ub2e4. HEADINFER\ub97c \ud3ec\ud568\ud55c \uc5ec\ub7ec \uac00\uc9c0 \ubc29\ubc95\uc744 \ube44\uad50\ud558\uc5ec GPU \uc131\ub2a5 \uc81c\ud55c \uc694\uc778\uacfc \uc131\ub2a5 \ud5a5\uc0c1 \ud6a8\uacfc\ub97c \ubd84\uc11d\ud569\ub2c8\ub2e4.", "section": "5. \ubd84\uc11d"}, {"figure_path": "https://arxiv.org/html/2502.12574/x9.png", "caption": "Figure 9: Demonstrations of KV cache policies in inference from the head-wise view. Upper plots illustrate symbolic plots of an attention map deploying different policies in LLM generation. Lower: the overview of HeadInfer.", "description": "\uadf8\ub9bc 9\ub294 \ud5e4\ub4dc \uad00\uc810\uc5d0\uc11c \ucd94\ub860 \uc2dc KV \uce90\uc2dc \uc815\ucc45\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. \uc704\ucabd \uadf8\ub9bc\uc740 LLM \uc0dd\uc131\uc5d0\uc11c \ub2e4\uc591\ud55c \uc815\ucc45\uc744 \uc801\uc6a9\ud55c \uc5b4\ud150\uc158 \ub9f5\uc758 \uc0c1\uc9d5\uc801 \uadf8\ub9bc\uc744 \ubcf4\uc5ec\uc8fc\uace0, \uc544\ub798\ucabd \uadf8\ub9bc\uc740 HeadInfer\uc758 \uac1c\uc694\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  HeadInfer\ub294 \uc5b4\ud150\uc158 \ud5e4\ub4dc \ub2e8\uc704\ub85c KV \uce90\uc2dc\ub97c \ub3d9\uc801\uc73c\ub85c \uc624\ud504\ub85c\ub4dc\ud558\uc5ec GPU \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub7c9\uc744 \uc904\uc774\uace0 \uae34 \ubb38\ub9e5 \uae38\uc774\ub97c \uc9c0\uc6d0\ud558\ub294 \ucd94\ub860 \ud504\ub808\uc784\uc6cc\ud06c\uc785\ub2c8\ub2e4.  \uadf8\ub9bc\uc740 \ud480 \ud5e4\ub4dc KV \uce90\uc2dc, \uc2ac\ub77c\uc774\ub529 \uc708\ub3c4\uc6b0 KV \uce90\uc2dc, HeadInfer + 50% \uc2a4\ud30c\uc2a4\ud2f0\uc2dc\ud2f0\uc758 \uc138 \uac00\uc9c0 \ubc29\ubc95\uc744 \ube44\uad50\ud558\uc5ec \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. HeadInfer\ub294 \ud480 \ud5e4\ub4dc \ubc29\uc2dd\ubcf4\ub2e4 GPU \uba54\ubaa8\ub9ac \ud6a8\uc728\uc774 \ud6e8\uc52c \ub192\uc73c\uba70, \uc2ac\ub77c\uc774\ub529 \uc708\ub3c4\uc6b0 \ubc29\uc2dd\ubcf4\ub2e4 \ub354 \uc815\ud655\ud55c \uacb0\uacfc\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4. HeadInfer + 50% \uc2a4\ud30c\uc2a4\ud2f0\uc2dc\ud2f0\ub294 \uc77c\ubd80 \ud5e4\ub4dc\ub97c \uc624\ud504\ub85c\ub4dc\ud558\uc5ec \uba54\ubaa8\ub9ac \uc0ac\uc6a9\ub7c9\uc744 \ub354\uc6b1 \uc904\uc774\ub294 \uac83\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.", "section": "3. HEADINFER: Head-wise Offload"}, {"figure_path": "https://arxiv.org/html/2502.12574/x10.png", "caption": "Figure 10: Workflow of HeadInfer generating a model with (n+1) layers and (j+1) attention heads.", "description": "\uadf8\ub9bc 10\uc740 HeadInfer\uac00 (n+1)\uac1c\uc758 \ub808\uc774\uc5b4\uc640 (j+1)\uac1c\uc758 \uc5b4\ud150\uc158 \ud5e4\ub4dc\ub97c \uac16\ub294 \ubaa8\ub378\uc744 \uc0dd\uc131\ud558\ub294 \uacfc\uc815\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  CPU \uba54\ubaa8\ub9ac\uc640 GPU \uba54\ubaa8\ub9ac \uc0ac\uc774\uc758 \ud551\ud401 \uba54\ubaa8\ub9ac \ub514\uc790\uc778\uc744 \uc0ac\uc6a9\ud558\uc5ec \ube44\ub3d9\uae30\uc801 \uc624\ud504\ub85c\ub529\uc744 \uc218\ud589\ud558\ub294 \ubc29\ubc95\uc744 \ubcf4\uc5ec\uc90d\ub2c8\ub2e4. GPU\ub294 \ud604\uc7ac \ud5e4\ub4dc\uc758 \uc5b4\ud150\uc158\uc744 \uacc4\uc0b0\ud558\ub294 \ub3d9\uc548, CPU\ub294 \ub2e4\uc74c \ud5e4\ub4dc\uc758 KV \uce90\uc2dc\ub97c \ubbf8\ub9ac \uac00\uc838\uc624\uace0 \uc774\uc804 \ud5e4\ub4dc\uc758 \uce90\uc2dc\ub97c \uc624\ud504\ub85c\ub4dc\ud569\ub2c8\ub2e4. \uc774\ub7ec\ud55c \uacb9\uce68\uc744 \ud1b5\ud574 GPU \uacc4\uc0b0\uacfc \uba54\ubaa8\ub9ac \uc774\ub3d9 \uc0ac\uc774\uc758 \ub3d9\uae30\ud654\ub97c \ubcf4\uc7a5\ud569\ub2c8\ub2e4.  \uac01 \ub808\uc774\uc5b4\uc640 \ud5e4\ub4dc\uc758 KV \uce90\uc2dc\uac00 GPU\uc640 CPU \uac04\uc5d0 \uc5b4\ub5bb\uac8c \uc774\ub3d9\ud558\ub294\uc9c0, \uadf8\ub9ac\uace0 \uac01 \ub2e8\uacc4\uc5d0\uc11c\uc758 \uba54\ubaa8\ub9ac \uc0c1\ud0dc\ub97c \uc2dc\uac01\uc801\uc73c\ub85c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4.  \ube44\ub3d9\uae30\uc801 \uc804\uc1a1\uc744 \uc0ac\uc6a9\ud558\uc5ec GPU \uc5f0\uc0b0\uc744 \uba54\ubaa8\ub9ac \uc774\ub3d9\uacfc \uacb9\uccd0 \ucc98\ub9ac \ud6a8\uc728\uc744 \ub192\uc785\ub2c8\ub2e4.", "section": "4. HEADINFER for Memory-Efficient Inference"}]